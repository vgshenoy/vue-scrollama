var VueScrollama=(function(R){"use strict";function X(r,l=document){return typeof r=="string"?Array.from(l.querySelectorAll(r)):r instanceof Element?[r]:r instanceof NodeList?Array.from(r):r instanceof Array?r:[]}function N(r){return`scrollama__debug-offset--${r}`}function Z({id:r,offsetVal:l,stepClass:f}){const i=document.createElement("div");i.id=N(r),i.className="scrollama__debug-offset",i.style.position="fixed",i.style.left="0",i.style.width="100%",i.style.height="0",i.style.borderTop="2px dashed black",i.style.zIndex="9999";const s=document.createElement("p");s.innerHTML=`".${f}" trigger: <span>${l}</span>`,s.style.fontSize="12px",s.style.fontFamily="monospace",s.style.color="black",s.style.margin="0",s.style.padding="6px",i.appendChild(s),document.body.appendChild(i)}function ee({id:r,offsetVal:l,stepEl:f}){const i=f[0].className;Z({id:r,offsetVal:l,stepClass:i})}function te({id:r,offsetMargin:l,offsetVal:f,format:i}){const s=i==="pixels"?"px":"",m=N(r),x=document.getElementById(m);x.style.top=`${l}px`,x.querySelector("span").innerText=`${f}${s}`}function Y({id:r,index:l,state:f}){const i=`scrollama__debug-step--${r}-${l}`,s=document.getElementById(`${i}_above`),m=document.getElementById(`${i}_below`),x=f==="enter"?"block":"none";s&&(s.style.display=x),m&&(m.style.display=x)}function oe(){const r=["stepAbove","stepBelow","stepProgress","viewportAbove","viewportBelow"];let l={},f={},i=null,s=[],m=[],x=[],u=[],y=0,g=0,S=0,V=0,k=0,D=0,z=!1,I=!1,B=!1,M=!1,j=!1,F=!1,h="down",T="percent";const L=[];function b(e){console.error(`scrollama error: ${e}`)}function U(){l={stepEnter:()=>{},stepExit:()=>{},stepProgress:()=>{}},f={}}function ce(){const e="abcdefghijklmnopqrstuv",t=e.length,o=Date.now();return`${[0,0,0].map(c=>e[Math.floor(Math.random()*t)]).join("")}${o}`}function le(e){const{top:t}=e.getBoundingClientRect(),o=window.pageYOffset,n=document.body.clientTop||0;return t+o-n}function ae(){const{body:e}=document,t=document.documentElement;return Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)}function $(e){return+e.getAttribute("data-scrollama-index")}function _(){window.pageYOffset>k?h="down":window.pageYOffset<k&&(h="up"),k=window.pageYOffset}function G(e){f[e]&&f[e].forEach(t=>t.disconnect())}function J(){S=window.innerHeight,V=ae(),g=y*(T==="pixels"?1:S),z&&(m=s.map(t=>t.getBoundingClientRect().height),x=s.map(le),I&&Q()),B&&te({id:i,offsetMargin:g,offsetVal:y,format:T})}function C(e){if(e&&!I)if(z)Q();else{b("scrollama error: enable() called before scroller was ready"),I=!1;return}!e&&I&&r.forEach(G),I=e}function pe(e){const t=Math.ceil(e/D),o=[],n=1/t;for(let c=0;c<t;c+=1)o.push(c*n);return o}function P(e,t){const o=$(e);t!==void 0&&(u[o].progress=t);const n={element:e,index:o,progress:u[o].progress};u[o].state==="enter"&&l.stepProgress(n)}function K(e,t){if(t==="above")for(let o=0;o<e;o+=1){const n=u[o];n.state!=="enter"&&n.direction!=="down"?(O(s[o],"down",!1),v(s[o],"down")):n.state==="enter"&&v(s[o],"down")}else if(t==="below")for(let o=u.length-1;o>e;o-=1){const n=u[o];n.state==="enter"&&v(s[o],"up"),n.direction==="down"&&(O(s[o],"up",!1),v(s[o],"up"))}}function O(e,t,o=!0){const n=$(e),c={element:e,index:n,direction:t};u[n].direction=t,u[n].state="enter",j&&o&&t==="down"&&K(n,"above"),j&&o&&t==="up"&&K(n,"below"),l.stepEnter&&!L[n]&&(l.stepEnter(c,u),B&&Y({id:i,index:n,state:"enter"}),F&&(L[n]=!0)),M&&P(e)}function v(e,t){const o=$(e),n={element:e,index:o,direction:t};M&&(t==="down"&&u[o].progress<1?P(e,1):t==="up"&&u[o].progress>0&&P(e,0)),u[o].direction=t,u[o].state="exit",l.stepExit(n,u),B&&Y({id:i,index:o,state:"exit"})}function fe([e]){_();const{isIntersecting:t,boundingClientRect:o,target:n}=e,{top:c,bottom:d}=o,a=c-g,w=d-g,A=$(n),E=u[A];t&&a<=0&&w>=0&&h==="down"&&E.state!=="enter"&&O(n,h),!t&&a>0&&h==="up"&&E.state==="enter"&&v(n,h)}function ue([e]){_();const{isIntersecting:t,boundingClientRect:o,target:n}=e,{top:c,bottom:d}=o,a=c-g,w=d-g,A=$(n),E=u[A];t&&a<=0&&w>=0&&h==="up"&&E.state!=="enter"&&O(n,h),!t&&w<0&&h==="down"&&E.state==="enter"&&v(n,h)}function de([e]){_();const{isIntersecting:t,target:o}=e,n=$(o),c=u[n];t&&h==="down"&&c.direction!=="down"&&c.state!=="enter"&&(O(o,"down"),v(o,"down"))}function ge([e]){_();const{isIntersecting:t,target:o}=e,n=$(o),c=u[n];t&&h==="up"&&c.direction==="down"&&c.state!=="enter"&&(O(o,"up"),v(o,"up"))}function me([e]){_();const{isIntersecting:t,intersectionRatio:o,boundingClientRect:n,target:c}=e,{bottom:d}=n,a=d-g;t&&a>=0&&P(c,+o)}function he(){f.viewportAbove=s.map((e,t)=>{const o=V-x[t],n=g-S-m[t],d={rootMargin:`${o}px 0px ${n}px 0px`},a=new IntersectionObserver(de,d);return a.observe(e),a})}function be(){f.viewportBelow=s.map((e,t)=>{const o=-g-m[t],n=g-S+m[t]+V,d={rootMargin:`${o}px 0px ${n}px 0px`},a=new IntersectionObserver(ge,d);return a.observe(e),a})}function we(){f.stepAbove=s.map((e,t)=>{const o=-g+m[t],n=g-S,d={rootMargin:`${o}px 0px ${n}px 0px`},a=new IntersectionObserver(fe,d);return a.observe(e),a})}function xe(){f.stepBelow=s.map((e,t)=>{const o=-g,n=g-S+m[t],d={rootMargin:`${o}px 0px ${n}px 0px`},a=new IntersectionObserver(ue,d);return a.observe(e),a})}function ye(){f.stepProgress=s.map((e,t)=>{const o=m[t]-g,n=-S+g,c=`${o}px 0px ${n}px 0px`,d=pe(m[t]),a={rootMargin:c,threshold:d},w=new IntersectionObserver(me,a);return w.observe(e),w})}function Q(){r.forEach(G),he(),be(),we(),xe(),M&&ye()}function ve(){s.forEach((e,t)=>e.setAttribute("data-scrollama-index",t))}function Se(){u=s.map(()=>({direction:null,state:null,progress:0}))}function $e(){B&&ee({id:i,stepEl:s,offsetVal:y})}function Ee(e){const t=window.getComputedStyle(e);return(t.overflowY==="scroll"||t.overflowY==="auto")&&e.scrollHeight>e.clientHeight}function W(e){return e&&e.nodeType===1?Ee(e)?e:W(e.parentNode):!1}const p={};return p.setup=({step:e,parent:t,offset:o=.5,progress:n=!1,threshold:c=4,debug:d=!1,order:a=!0,once:w=!1})=>{if(U(),i=ce(),s=X(e,t),!s.length)return b("no step elements"),p;const A=s.reduce((E,Oe)=>E||W(Oe.parentNode),!1);return A&&console.error("scrollama error: step elements cannot be children of a scrollable element. Remove any css on the parent element with overflow: scroll; or overflow: auto; on elements with fixed height.",A),B=d,M=n,j=a,F=w,p.offsetTrigger(o),D=Math.max(1,+c),z=!0,$e(),ve(),Se(),J(),p.enable(),p},p.resize=()=>(J(),p),p.enable=()=>(C(!0),p),p.disable=()=>(C(!1),p),p.destroy=()=>{C(!1),U()},p.offsetTrigger=e=>{if(e===null)return y;if(typeof e=="number")T="percent",e>1&&b("offset value is greater than 1. Fallback to 1."),e<0&&b("offset value is lower than 0. Fallback to 0."),y=Math.min(Math.max(0,e),1);else if(typeof e=="string"&&e.indexOf("px")>0){const t=+e.replace("px","");isNaN(t)?(b("offset value must be in 'px' format. Fallback to 0.5."),y=.5):(T="pixels",y=t)}else b("offset value does not include 'px'. Fallback to 0.5."),y=.5;return p},p.onStepEnter=e=>(typeof e=="function"?l.stepEnter=e:b("onStepEnter requires a function"),p),p.onStepExit=e=>(typeof e=="function"?l.stepExit=e:b("onStepExit requires a function"),p),p.onStepProgress=e=>(typeof e=="function"?l.stepProgress=e:b("onStepProgress requires a function"),p),p}const ne=(r,l)=>{const f=r.__vccOpts||r;for(const[i,s]of l)f[i]=s;return f},se={name:"Scrollama",inheritAttrs:!1,emits:["step-progress","step-enter","step-exit"],data(){return{scroller:null}},computed:{opts(){const r=this.$&&this.$.vnode&&this.$.vnode.props?this.$.vnode.props:{},l=Object.prototype.hasOwnProperty.call(r,"onStepProgress");return Object.assign({},{step:Array.from(this.$el.children),progress:l},this.$attrs)}},mounted(){this.scroller=oe(),this.setup()},beforeUnmount(){this.scroller&&this.scroller.destroy(),window.removeEventListener("resize",this.handleResize)},methods:{setup(){this.scroller&&(this.scroller.destroy(),this.scroller.setup(this.opts).onStepProgress(r=>{this.$emit("step-progress",r)}).onStepEnter(r=>{this.$emit("step-enter",r)}).onStepExit(r=>{this.$emit("step-exit",r)}),window.addEventListener("resize",this.handleResize))},handleResize(){this.scroller&&this.scroller.resize()}}},re={class:"scrollama__steps"};function ie(r,l,f,i,s,m){return R.openBlock(),R.createElementBlock("div",re,[R.renderSlot(r.$slots,"default")])}const q=ne(se,[["render",ie]]),H=typeof globalThis<"u"?globalThis.Vue:void 0;return H&&typeof H.component=="function"&&H.component("Scrollama",q),q})(Vue);
